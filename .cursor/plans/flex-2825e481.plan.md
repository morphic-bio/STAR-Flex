<!-- 2825e481-a59b-4550-894c-d8d92d6a7932 a09411e1-101c-404b-b975-b6d7cc3b752e -->
# Flex Documentation Update

## Deliverables

### 1. Update `README_flex.md`

- Fix parameter names: `--flexEnable` -> `--flex yes`
- Update flags table with actual `soloFlex*` parameters:
- `--flex yes` (master switch)
- `--soloFlexExpectedCellsPerTag` / `--soloFlexExpectedCellsTotal`
- `--soloFlexAllowedTags`, `--soloFlexOutputPrefix`
- Sample params: `--soloSampleWhitelist`, `--soloProbeList`, `--soloSampleProbes`, `--soloSampleProbeOffset`
- Add working usage example based on `reference/runSTAR.sh`
- Add section referencing `scripts/` for building flex references, link to `scripts/README.md`

### 2. Create `docs/flex_methodology.md`

Technical overview covering:

- Data flow: ReadAlign sample detection -> SoloReadFeature inline hash -> SoloFeature merge -> CB/UMI correction -> collapse -> MEX/FlexFilter
- Hash schema (CB, TAG, gene, UMI via khash)
- CB correction (CbCorrector, 1MM with pseudocounts)
- UMI correction (clique-based, 1MM_CR)
- Sample tag/probe handling
- FlexFilter stages: OrdMag (simple EmptyDrops) vs full EmptyDrops
- Output structure (raw MEX, per-sample MEX, filtered)

### 3. Create `docs/TESTING_flex.md`

- How to run the multi-sample test (`tests/run_flex_multisample_test.sh`)
- How to run baseline regression (`tests/run_baseline_test.sh`)
- Expected outputs and sanity checks
- Reference gold standard files bundled in `tests/gold_standard/`

### 4. Bundle gold standard MEX files

- Copy baseline MEX from `/storage/100K/SC2300771/Solo.out/Gene/raw/` to `tests/gold_standard/raw/`
- Copy per-sample MEX from `/storage/100K/SC2300771/per_sample/` to `tests/gold_standard/per_sample/`
- Update test scripts to use local gold standard paths (removes external dependency)

### 5. Scripts reference (no new files needed)

- Scripts already exist in `scripts/` with `scripts/README.md`
- Just add a section in `README_flex.md` pointing users there