==========================================
Bulk Paired-End Y/NoY Split Validation Test
==========================================
Binary: /mnt/pikachu/STAR-Flex/tests/../source/STAR
Base directory: /tmp/ychrom_bulk_pe_test
Dataset: /storage/PE/downsampled/21033-09-01-13-01_S1_L007_R1_001.fastq.gz, /storage/PE/downsampled/21033-09-01-13-01_S1_L007_R2_001.fastq.gz

>>> Step 1: Baseline Run (no Y-split)
Dec 12 10:51:18 ..... started STAR run
Dec 12 10:51:31 ..... started mapping
Dec 12 10:51:40 ..... finished mapping
Dec 12 10:51:41 ..... finished successfully
  Baseline total reads: 270089
  Baseline chrY reads (idxstats): 0
  Baseline chrY reads (direct count): 570

>>> Step 2: Unsorted Split Run
Dec 12 10:51:42 ..... started STAR run
Dec 12 10:51:54 ..... started mapping
Dec 12 10:52:04 ..... finished mapping
Dec 12 10:52:05 ..... finished successfully

>>> Step 3: Sorted Split Run
Dec 12 10:52:05 ..... started STAR run
Dec 12 10:52:18 ..... started mapping
Dec 12 10:52:27 ..... finished mapping
Dec 12 10:52:28 ..... started sorting BAM
Dec 12 10:52:30 ..... finished successfully

>>> Step 4: Validation Checks
  Validating unsorted mode...
    Y reads: 5639
    noY reads: 264450
    Total: 270089
    ✓ Count consistency: Y + noY = baseline (270089)
    ✓ noY exclusivity: zero chrY reads in _noY.bam
    ✓ Y exclusivity: reads in _Y.bam have chrY alignments (direct or via mate)
    ✓ Mate consistency: no read names appear in both Y and noY files
  Validating sorted mode...
    Y reads: 5639
    noY reads: 264450
    Total: 270089
    ✓ Count consistency: Y + noY = baseline (270089)
    ✓ noY exclusivity: zero chrY reads in _noY.bam
    ✓ Y exclusivity: reads in _Y.bam have chrY alignments (direct or via mate)
    ✓ Mate consistency: no read names appear in both Y and noY files

>>> Step 5: Mate-Checking Verification (Bulk Paired-End)
  Checking if mates route together when one mate is on chrY...
  ✓ Mate-checking: all sampled reads route consistently (mates together)

>>> Step 6: Generating Report
  Report written to: /mnt/pikachu/STAR-Flex/tests/TEST_REPORT_Y_SPLIT_BULK_PE.md

==========================================
Test Summary
==========================================
Validation checks passed: 9
Validation checks failed: 0

✓ All validation checks passed!
