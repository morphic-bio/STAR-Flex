==========================================
Flex Y/NoY Split Validation Test
==========================================
Binary: /mnt/pikachu/STAR-Flex/tests/../source/STAR
Base directory: /tmp/ychrom_flex_test
Dataset: /storage/downsampled/SC2300771

>>> Step 1: Baseline Run (no Y-split)
Dec 12 09:50:44 ..... started STAR run
Dec 12 09:51:18 ..... started mapping
Dec 12 09:51:24 ..... finished mapping
Dec 12 09:51:26 ..... started Solo counting
Dec 12 09:51:35 ..... finished Solo counting
Dec 12 09:51:35 ..... finished successfully
  Baseline total reads: 151289
  Baseline chrY reads: 
tests/run_ychrom_flex_validation_test.sh: line 111: [: : integer expression expected

>>> Step 2: Unsorted Split Run
Dec 12 09:51:43 ..... started STAR run
Dec 12 09:52:09 ..... started mapping
Dec 12 09:52:15 ..... finished mapping
Dec 12 09:52:16 ..... started Solo counting
Dec 12 09:52:26 ..... finished Solo counting
Dec 12 09:52:26 ..... finished successfully

>>> Step 3: Sorted Split Run
Dec 12 09:52:33 ..... started STAR run
Dec 12 09:53:00 ..... started mapping
Dec 12 09:53:05 ..... finished mapping
Dec 12 09:53:06 ..... started Solo counting
Dec 12 09:53:15 ..... finished Solo counting
Dec 12 09:53:15 ..... started sorting BAM
Dec 12 09:53:18 ..... finished successfully

>>> Step 4: Validation Checks
  Validating unsorted mode...
    Y reads: 499
    noY reads: 150790
    Total: 151289
    ✓ Count consistency: Y + noY = baseline (151289)
tests/run_ychrom_flex_validation_test.sh: line 208: [: : integer expression expected
    ✗ noY exclusivity FAILED:  chrY reads in _noY.bam
    ✗ Y exclusivity FAILED: 382 non-chrY reads in _Y.bam
  Validating sorted mode...
    Y reads: 499
    noY reads: 150790
    Total: 151289
    ✓ Count consistency: Y + noY = baseline (151289)
    ✓ noY exclusivity: zero chrY reads in _noY.bam
    ✗ Y exclusivity FAILED: 382 non-chrY reads in _Y.bam

>>> Step 5: SAM-level Comparison (sorted mode)
  Generating baseline-derived SAMs...
  ✗ Y SAM comparison: differences found
    Diff saved to: /tmp/ychrom_flex_test/sam_comparison/Y_diff.txt
  ✗ noY SAM comparison: differences found
    Diff saved to: /tmp/ychrom_flex_test/sam_comparison/noY_diff.txt

>>> Step 6: Generating Report
  Report written to: /mnt/pikachu/STAR-Flex/tests/TEST_REPORT_Y_SPLIT_FLEX.md

==========================================
Test Summary
==========================================
Validation checks passed: 3
Validation checks failed: 5

✗ Some validation checks failed
See report: /mnt/pikachu/STAR-Flex/tests/TEST_REPORT_Y_SPLIT_FLEX.md
